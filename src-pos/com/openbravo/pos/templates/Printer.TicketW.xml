<?xml version="1.0" encoding="UTF-8"?>

<output>
    <opendrawer/>
    <display>
        <line>
            <text align="left" length="10">Total</text>
            <text align="right" length="10">${ticket.printTotal()}</text>
        </line>
        <line>
           <text align="center" length="20">Gracias</text>
        </line>
    </display>
    <ticket>
        <!-- <image>Printer.Ticket.Logo</image>
        <line></line> -->
        <line size="1" bold="true">
            <text align="center" length="40">Peonia Boutique</text>
        </line>
        <!-- <line>
            <text align="center" length="40">Montes verdes #165-A Lomas 1° Sección</text>
        </line>
        <line>
            <text align="center" length="40">C.P. 78210 Tel. 01 (444) 151-09-73</text>
        </line>
        <line>
            <text align="center" length="40">San Luis Potosí, S.L.P. México</text>
        </line> -->
        <line></line>
        #if (${ticket.ticketType} == 0)
        <line>
            <text align="right" length="10">Folio:</text>
            <text>${ticket.printId()}</text>
        </line>
        #end
        #if (${ticket.ticketType} == 1)
        <line>
            <text align="right" length="10">Reembolso:</text>
            <text>${ticket.printId()}</text>
        </line>
        #end
        <line>
            <text align="right" length="10">Fecha:</text>
            <text>${ticket.printDate()}</text>
        </line>
         #if ($ticket.getCustomer())
        <line>
            <text align="right" length="10">Cliente:</text>
            <text>${ticket.getCustomer().printName()}</text>
        </line>      
        <!-- <line>
            <text align="left" length="15"></text>
            <text>${ticket.getCustomer().printTaxid()}</text>
        </line> -->
        #end
        #if ($place != "")
        <line>
            <text align="right" length="10">Mesa de regalos:</text>
            <text>${place}</text>
        </line>  
        #end
        <line></line>    
        <line>
            <text align ="center" length="18">Producto</text>
            <text align ="center" length="8">Precio</text>
            <text align ="center" length="4">Cant</text>
            <text align ="center" length="10">Costo</text>
            <!--<text align ="right" length="5"></text>
            <text align ="right" length="10">Value</text>-->
        </line>      
        <line>
             <text>----------------------------------------</text>
        </line>   
        #set($discount = 0)
        #set($refundMM = 0)
        #foreach ($ticketline in $ticket.getLines())
            <line>
                #if ($ticketline.isProductCom()) 
                    <text align ="left" length="18">*${ticketline.printName()}</text>
                #else
                    <text align ="left" length="18">${ticketline.printName()}</text>
                #end
                <text align ="right" length="8">${ticketline.printPrice()}</text>
                <text align ="center" length="4">x${ticketline.printMultiply()}</text>
                <text align ="right" length="10">${ticketline.printSubValue()}</text>
            </line> 
            #if ($ticketline.productAttSetInstId)
                <line>
                    <text align ="left" length="42">${ticketline.productAttSetInstDesc}</text>
                </line>
            #end
            #if ($ticketline.getMultiply() < 0.0)
                #set($refundMM = $refundMM + 1)
            #end            
            #if ($ticketline.getPrice() < 0.0) 
                #set($discount = $discount + 1) 
            #end
        #end
        <line>
             <text>----------------------------------------</text>
        </line>
        <line>  
            <text>Total de productos:</text>
            #if ($ticket.getArticlesCount() > 0)
	    	#set($items = $ticket.getArticlesCount())
		#set($items = $items + "")
                #set($items = $items.substring(0, $items.indexOf(".")))
	    #end
            #if ($refundMM > 0)
                #set($items = $refundMM)
            #end
            #if ($ticket.getArticlesCount() > 0 and $discount > 0)
                #set($items = $ticket.getArticlesCount() - $discount)
                #set($items = $items + "")
                #set($items = $items.substring(0, $items.indexOf(".")))
            #end
            #if ($ticket.getArticlesCount() > 0 and $refundMM > 0)
                #set($items = $ticket.getArticlesCount() + $refundMM)
                #set($items = $items + "")
                #set($items = $items.substring(0, $items.indexOf(".")))
            #end
            #if ($ticket.getArticlesCount() > 0 and $discount > 0 and $refundMM > 0)
                #set($items = $ticket.getArticlesCount() + $refundMM - $discount)
                #set($items = $items + "")
                #set($items = $items.substring(0, $items.indexOf(".")))
            #end
            <text align ="left" length="5">$items</text>
        </line> 
        <line></line>
	#foreach ($taxinfo in $taxes)  
        <!-- #set( $taxline = $ticket.getTaxLine($taxinfo)) Por el tema de la impresion del preticket -->
	<!-- <line>
	<text align ="left" length="18">${taxline.getTaxInfo()}</text>  
	<text align ="right" length="12">${taxline.printSubTotal()}</text> 
	<text align ="right" length="12">${taxline.printTax()}</text> 
	</line> -->
	#end 
	<!-- <line> </line> -->
        <!-- <line>
            <text align ="left" length="16">Subtotal.</text>
            <text align ="right" length="20">${ticket.printSubTotal()}</text>
        </line> 
        <line>
            <text align ="left" length="16">Impuestos.</text>
            <text align ="right" length="20">${ticket.printTax()}</text>
        </line> 
        <line></line> -->
        <line size="1" bold="true">
            <text align="right" length="17"> </text>
            <text align="right" length="6">Total:</text>
            <text align="left" length="17">${ticket.printTotal()} Pesos</text>
        </line>    
        #foreach ($paymentline in $ticket.payments)      
         #if ($paymentline.name == "cash")
        <!-- <line></line> -->
        <line>
            <text length="14"> </text>
            <text align="center" length="26">Efectivo</text>
        </line>  
        <line align="right">
             <text align="right" length="14"> </text>
             <text align="right" length="9">Pago con:</text>
             <text align="left" length="17">${paymentline.printPaid()} Pesos</text>
         </line>  
        <line align="right">
            <text align="right" length="16"> </text>
            <text align="right" length="7">Cambio:</text>
            <text align ="left" length="17">${paymentline.printChange()} Pesos</text>
        </line>   
         #end
         #if ($paymentline.name == "cashrefund")
        <line></line>     
        <line>
            <text legth="14"> </text>
            <text align="center" length="26">Reembolso</text>
         </line>
        <line>
            <text align="right" length="23"> </text>
            <text align ="left" length="17">${paymentline.printTotal()}</text>
        </line>    
         #end
         #if ($paymentline.name == "magcard")
        <line></line>        
        <line>
            <text bold="true">Tarjeta</text>
        </line>   
         <line>
            <text align ="right" length="40">${paymentline.printTotal()}</text>
        </line>    
        <line>
            <text align ="left" length="22">Numero:</text>
            <text>${paymentline.printCardNumber()}</text>
        </line>
        <line>
            <text align ="left" length="22">Fecha de expiración:</text>
            <text>${paymentline.printExpirationDate()}</text>
        </line>
        <line>
            <text align ="left" length="22">Operación:</text>
            <text>${paymentline.printTransactionID()}</text>
        </line>
        <line>
            <text align ="left" length="22">Autorización:</text>
            <text>${paymentline.printAuthorization()}</text>
        </line>
         #end  
         #if ($paymentline.name == "magcardrefund")
        <line></line>     
        <line>
            <text bold="true">Reembolso de tarjeta</text>
        </line>    
        <line>
            <text align ="right" length="40">${paymentline.printTotal()}</text>
        </line>    
         #end
         #if ($paymentline.name == "cheque")
        <line></line>     
        <line>
            <text bold="true">Cheque</text>
        </line>    
        <line>
            <text align ="right" length="40">${paymentline.printTotal()}</text>
        </line>    
         #end
         #if ($paymentline.name == "chequerefund")
        <line></line>     
        <line>
            <text bold="true">Reembolso de cheque</text>
        </line>    
        <line>
            <text align ="right" length="42">${paymentline.printTotal()}</text>
        </line>    
         #end
         #if ($paymentline.name == "paperin")
        <line></line>     
        <line>
            <text bold="true">Nota</text>
        </line>    
        <line>
            <text align ="right" length="40">${paymentline.printTotal()}</text>
        </line>    
         #end
         #if ($paymentline.name == "paperout")
        <line></line>     
        <line>
            <text bold="true">Reembolso de nota</text>
        </line>    
        <line>
            <text align ="right" length="40">${paymentline.printTotal()}</text>
        </line>    
         #end
         #if ($paymentline.name == "free")
        <line></line>     
        <line>
            <text bold="true">Gratis</text>
        </line>    
        <line>
            <text align ="right" length="40">${paymentline.printTotal()}</text>
        </line>    
         #end
         #if ($paymentline.name == "debt")
        <line></line>     
        <line size="1">
            <text length="14"> </text>
            <text align="center" length="26" bold="true">Apartado</text>
        </line>     
        <line>
            <text align="center" length="40">Este apartado tiene una</text>
        </line>
        <line>
            <text align="center" length="40">vigencia de 30 días naturales.</text>
        </line>
        <line>
            <text align="center" length="40">Queda en el entendido de que en caso</text>
        </line>
        <line>
            <text align="center" length="40">de no liquidarlo antes de su</text>
        </line>
        <line>
            <text align="center" length="40">vencimiento, Peonia Boutique</text>
        </line>
        <line>
            <text align="center" length="40">podrá disponer de este para su venta</text>
        </line>
        <line>
            <text align="center" length="40">y en ningún caso habrá devolución de</text>
        </line>
        <line>
            <text align="center" length="40">efectivo o de mercancía.</text>
        </line>
        <line></line>
        <line></line>
        <line></line>
        <line>
            <text>----------------------------------------</text>
        </line>
        <line>
            <text align="center" length="40">${ticket.getCustomer().printName()}</text>
        </line>
        <line>
            <text align="center" length="40">Firma de conformidad</text>
        </line>    
         #end 
         #end 
        <line></line>
        <line>
            <text align="right" length="10">Caja:</text>
            <text>${host}</text>
        </line>
        <line>
            <text align="right" length="10">Cajero:</text>
            <text>${ticket.printUser()}</text>
        </line> 
        <line></line>            
        <line>
            <text align="center" length="40">¡¡¡Gracias por su visita!!!</text>
        </line>   
    </ticket>
    <!-- #foreach ($paymentline in $ticket.payments)
     #if ($paymentline.name == "cash")
    <opendrawer/>
     #end
     #if ($paymentline.name == "cashrefund")
    <opendrawer/>
     #end  
    #end -->
</output>